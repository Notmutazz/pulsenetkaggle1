<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>PulseNet - AI Disaster Intelligence (Kaggle Model)</title>
Â  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
Â  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
Â  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
Â  <style>
Â  Â  body { overflow-x: hidden; font-family: 'Inter', sans-serif; background: #0a0f1c; color: #ffffff; }
Â  Â  #map { height: 100%; width: 100%; }
Â  Â  .page-transition { opacity: 0; transform: translateY(20px); transition: all 0.5s ease; }
Â  Â  .page-transition.active { opacity: 1; transform: translateY(0); }
Â  Â  .glassmorphism-sidebar { background: rgba(10, 15, 28, 0.7); backdrop-filter: blur(25px); border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 20px; box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5); }
Â  Â  .input-field { background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 12px 16px; color: white; width: 100%; margin-bottom: 1rem; transition: all 0.3s ease; }
Â  Â  .input-field:focus { outline: none; border-color: #10b981; box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2); }
Â  Â  .modern-btn { position: relative; overflow: hidden; border-radius: 50px; padding: 14px 28px; font-weight: 700; font-size: 1rem; transition: all 0.4s ease; border: 1px solid rgba(255, 255, 255, 0.2); }
Â  Â  .modern-btn:hover { transform: translateY(-3px) scale(1.03); }
Â  Â  .btn-primary { background: linear-gradient(135deg, #10b981, #059669); color: white; }
Â  Â  .dashboard-card { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(20px); border-radius: 16px; border-left-width: 4px; border-color: transparent; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); transition: all 0.4s ease; }
Â  Â  .dashboard-card:hover { transform: translateY(-5px); }
Â  </style>
</head>
<body class="antialiased">

<div id="app" class="flex flex-col h-screen">
Â  <header class="bg-gray-900/50 backdrop-filter backdrop-blur-lg p-4 flex justify-between items-center z-20 border-b border-gray-700">
Â  Â  <h1 class="text-2xl font-bold tracking-tight">Pulse<span class="text-green-400">Net</span></h1>
Â  Â  <nav class="space-x-2">
Â  Â  Â  <button id="homeBtn" class="px-3 py-2 text-gray-300 hover:text-white rounded-md">Home</button>
Â  Â  Â  <button id="liveMapBtn" class="px-3 py-2 text-gray-300 hover:text-white rounded-md">Live Map</button>
Â  Â  Â  <button id="testBtn" class="px-3 py-2 text-gray-300 hover:text-white rounded-md">Test Model</button>
Â  Â  </nav>
Â  </header>

Â  <main class="relative flex-grow overflow-hidden">
Â  Â  <div id="landingPage" class="page-transition active absolute inset-0 flex flex-col items-center justify-center p-8 text-center">
Â  Â  Â  <h2 class="text-5xl md:text-7xl font-extrabold mb-4">AI Disaster Intelligence</h2>
Â  Â  Â  <p class="text-lg text-gray-300 mb-8 max-w-2xl">Using a model trained on real-world Kaggle data to predict extreme weather events in Delhi.</p>
Â  Â  Â  <button id="landingLiveMapBtn" class="modern-btn btn-primary">Explore Live Risk Map</button>
Â  Â  </div>

Â  Â  <div id="liveMapPage" class="page-transition hidden absolute inset-0 flex">
Â  Â  Â  <div id="map" class="flex-grow"></div>
Â  Â  Â  <div class="w-96 p-6 overflow-y-auto glassmorphism-sidebar">
Â  Â  Â  Â  <h3 class="text-2xl font-bold mb-4">Live Risk Overview</h3>
Â  Â  Â  Â  <div class="mb-4">
Â  Â  Â  Â  Â  <select id="citySelector" class="input-field text-sm w-full">
Â  Â  Â  Â  Â  Â  <option value="Delhi">Delhi, India</option>
Â  Â  Â  Â  Â  Â  <option value="Mumbai">Mumbai, India</option>
Â  Â  Â  Â  Â  Â  <option value="Chennai">Chennai, India</option>
Â  Â  Â  Â  Â  Â  <option value="Bengaluru">Bengaluru, India</option>
Â  Â  Â  Â  Â  Â  <option value="Kolkata">Kolkata, India</option>
Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="riskCards" class="space-y-4"></div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="testPage" class="page-transition hidden absolute inset-0 overflow-y-auto p-8">
Â  Â  Â  <div class="max-w-md mx-auto">
Â  Â  Â  Â  <h2 class="text-4xl font-bold text-center mb-8">Test Kaggle AI Model</h2>
Â  Â  Â  Â  <div class="p-6 bg-gray-800/50 rounded-lg">
Â  Â  Â  Â  Â  <form id="testForm">
Â  Â  Â  Â  Â  Â  <div class="mb-4">
Â  Â  Â  Â  Â  Â  Â  <label class="block text-sm font-medium text-gray-300 mb-2">Mean Temperature (Â°C)</label>
Â  Â  Â  Â  Â  Â  Â  <input type="number" step="0.1" id="meantemp" class="input-field" placeholder="e.g., 25.5" required>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="mb-4">
Â  Â  Â  Â  Â  Â  Â  <label class="block text-sm font-medium text-gray-300 mb-2">Humidity (%)</label>
Â  Â  Â  Â  Â  Â  Â  <input type="number" step="0.1" id="humidity" class="input-field" placeholder="e.g., 75.5" required>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="mb-4">
Â  Â  Â  Â  Â  Â  Â  <label class="block text-sm font-medium text-gray-300 mb-2">Wind Speed (km/h)</label>
Â  Â  Â  Â  Â  Â  Â  <input type="number" step="0.1" id="wind_speed" class="input-field" placeholder="e.g., 8.2" required>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="mb-6">
Â  Â  Â  Â  Â  Â  Â  <label class="block text-sm font-medium text-gray-300 mb-2">Mean Pressure (hPa)</label>
Â  Â  Â  Â  Â  Â  Â  <input type="number" step="0.1" id="meanpressure" class="input-field" placeholder="e.g., 1010.5" required>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="mb-6">
Â  Â  Â  Â  Â  Â  Â  <label class="block text-sm font-medium text-gray-300 mb-2">Rainfall (mm)</label>
Â  Â  Â  Â  Â  Â  Â  <input type="number" step="0.1" id="rainfall" class="input-field" placeholder="e.g., 250.0" required>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <button type="submit" id="testSubmit" class="modern-btn btn-primary w-full">
Â  Â  Â  Â  Â  Â  Â  Predict Risk
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  <div id="testResult" class="hidden mt-6 p-4 rounded-lg"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>
Â  </main>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
Â  const pages = { landing: document.getElementById('landingPage'), liveMap: document.getElementById('liveMapPage'), test: document.getElementById('testPage'), };
Â  const navButtons = { home: document.getElementById('homeBtn'), liveMap: document.getElementById('liveMapBtn'), test: document.getElementById('testBtn'), landingLiveMap: document.getElementById('landingLiveMapBtn'), };
Â  const API_BASE_URL = 'http://127.0.0.1:8000';
Â  const cityCoordinates = { 'Bengaluru': [12.9716, 77.5946], 'Mumbai': [19.0760, 72.8777], 'Chennai': [13.0827, 80.2707], 'Delhi': [28.7041, 77.1025], 'Kolkata': [22.5726, 88.3639] };
Â  // UPDATED: Added a yellow color for warnings
Â  const COLORS = { green: '#10b981', red: '#ef4444', yellow: '#F59E0B' };
Â  let map;

Â  function showPage(pageKey) {
Â  Â  Object.values(pages).forEach(p => p.classList.add('hidden'));
Â  Â  pages[pageKey].classList.remove('hidden');
Â  Â  setTimeout(() => { Object.values(pages).forEach(p => p.classList.remove('active')); pages[pageKey].classList.add('active'); }, 50);
Â  Â  if (pageKey === 'liveMap' && !map) initializeMap();
Â  Â  if (pageKey === 'liveMap') { setTimeout(() => map.invalidateSize(), 300); fetchAndDisplayRiskData(); }
Â  }

Â  navButtons.home.onclick = () => showPage('landing');
Â  navButtons.liveMap.onclick = () => showPage('liveMap');
Â  navButtons.test.onclick = () => showPage('test');
Â  navButtons.landingLiveMap.onclick = () => showPage('liveMap');

Â  function initializeMap() {
Â  Â  map = L.map('map').setView(cityCoordinates['Delhi'], 11);
Â  Â  L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', { attribution: '&copy; CartoDB &copy; OpenStreetMap' }).addTo(map);
Â  }

Â  // --- UPDATED JAVASCRIPT FUNCTIONS FOR KAGGLE MODEL ---
Â  function getRiskColor(prediction) {
Â  Â  if (prediction === 'heatwave' || prediction === 'flood') {
Â  Â  Â  return COLORS.red; // Use red for severe warnings
Â  Â  } else {
Â  Â  Â  return COLORS.green; // Use green for normal conditions
Â  Â  }
Â  }

Â  function getRiskText(prediction) {
Â  Â  if (prediction === 'heatwave') {
Â  Â  Â  return 'Heatwave Warning';
Â  Â  } else if (prediction === 'flood') {
Â  Â  Â  return 'Flood Warning';
Â  Â  } else {
Â  Â  Â  return 'Normal Conditions';
Â  Â  }
Â  }
Â  // --- END OF UPDATED FUNCTIONS ---

Â  const citySelector = document.getElementById('citySelector');
Â  citySelector.addEventListener('change', fetchAndDisplayRiskData);

Â  async function fetchAndDisplayRiskData() {
Â  Â  const city = citySelector.value;
Â  Â  const riskCardsContainer = document.getElementById('riskCards');
Â  Â  riskCardsContainer.innerHTML = `<div class="text-center p-4 text-gray-400">Loading data for ${city}...</div>`;
Â  Â  try {
Â  Â  Â  const response = await fetch(`${API_BASE_URL}/predict-live?city=${city}`);
Â  Â  Â  const data = await response.json();
Â  Â  Â  if (!response.ok) throw new Error(data.detail || 'Failed to fetch');
Â  Â  Â  riskCardsContainer.innerHTML = '';
Â  Â  Â  const riskColor = getRiskColor(data.prediction);
Â  Â  Â  const card = document.createElement('div');
Â  Â  Â  card.className = `dashboard-card p-4`;
Â  Â  Â  card.style.borderColor = riskColor;
Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  <h4 class="font-bold text-lg">${data.city}</h4>
Â  Â  Â  Â  <div class="text-sm text-gray-300 mt-2">
Â  Â  Â  Â  Â  Â  <p><strong>Status:</strong> <span style="color:${riskColor}; font-weight: bold;">${getRiskText(data.prediction)}</span></p>
Â  Â  Â  Â  Â  Â  <p>ğŸŒ¡ï¸ Temp: ${data.weather.meantemp.toFixed(1)}Â°C</p>
Â  Â  Â  Â  Â  Â  <p>ğŸ’§ Humidity: ${data.weather.humidity.toFixed(0)}%</p>
Â  Â  Â  Â  Â  Â  <p>ğŸ’¨ Wind: ${data.weather.wind_speed.toFixed(1)} km/h</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>ğŸŒ§ï¸ Rainfall: ${data.weather.rainfall.toFixed(1)} mm</p>
Â  Â  Â  Â  </div>`;
Â  Â  Â  riskCardsContainer.appendChild(card);
Â  Â  Â  if (map) {
Â  Â  Â  Â  map.eachLayer(l => { if (l instanceof L.Marker) map.removeLayer(l); });
Â  Â  Â  Â  L.marker(cityCoordinates[city]).addTo(map).bindPopup(`<b>${city}</b><br>${getRiskText(data.prediction)}`).openPopup();
Â  Â  Â  Â  map.setView(cityCoordinates[city], 11);
Â  Â  Â  }
Â  Â  } catch (error) {
Â  Â  Â  riskCardsContainer.innerHTML = `<div class="p-4 text-red-400">Error: ${error.message}</div>`;
Â  Â  }
Â  }

Â  const testForm = document.getElementById('testForm');
Â  testForm.addEventListener('submit', async (e) => {
Â  Â  e.preventDefault();
Â  Â  const resultDiv = document.getElementById('testResult');
Â  Â  const submitBtn = document.getElementById('testSubmit');
Â  Â  submitBtn.textContent = 'Predicting...';
Â  Â  submitBtn.disabled = true;

Â  Â  // --- UPDATED JAVASCRIPT OBJECT FOR KAGGLE MODEL ---
Â  Â  // NEW: Added rainfall field to the data sent to the API
Â  Â  const weatherData = {
Â  Â  Â  meantemp: parseFloat(document.getElementById('meantemp').value),
Â  Â  Â  humidity: parseFloat(document.getElementById('humidity').value),
Â  Â  Â  wind_speed: parseFloat(document.getElementById('wind_speed').value),
Â  Â  Â  meanpressure: parseFloat(document.getElementById('meanpressure').value),
Â  Â  Â  rainfall: parseFloat(document.getElementById('rainfall').value)
Â  Â  };
Â  Â  // --- END OF UPDATED OBJECT ---

Â  Â  try {
Â  Â  Â  const response = await fetch(`${API_BASE_URL}/predict`, {
Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  headers: {'Content-Type': 'application/json'},
Â  Â  Â  Â  body: JSON.stringify(weatherData)
Â  Â  Â  });
Â  Â  Â  const data = await response.json();
Â  Â  Â  if (!response.ok) throw new Error(data.detail || 'Prediction failed');
Â  Â  Â  const riskColor = getRiskColor(data.prediction);
Â  Â  Â  resultDiv.innerHTML = `<p class="text-lg font-semibold" style="color:${riskColor};">Result: ${getRiskText(data.prediction)}</p>`;
Â  Â  Â  resultDiv.className = 'mt-6 p-4 rounded-lg';
Â  Â  Â  resultDiv.style.backgroundColor = `${riskColor}20`;
Â  Â  Â  resultDiv.classList.remove('hidden');
Â  Â  } catch (error) {
Â  Â  Â  resultDiv.innerHTML = `<p class="text-red-400">Error: ${error.message}</p>`;
Â  Â  Â  resultDiv.className = 'mt-6 p-4 rounded-lg bg-red-900/50';
Â  Â  Â  resultDiv.classList.remove('hidden');
Â  Â  } finally {
Â  Â  Â  submitBtn.textContent = 'Predict Risk';
Â  Â  Â  submitBtn.disabled = false;
Â  Â  }
Â  });

Â  showPage('landing');
});
</script>
</body>
</html>
